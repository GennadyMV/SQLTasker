<!DOCTYPE html>
<!--
To change this license header, choose License Headers in Project Properties.
To change this template file, choose Tools | Templates
and open the template in the editor.
-->
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.w3.org/1999/xhtml">
    <head>
        <title th:text="${task.name}">Task name</title>
        <link th:include="fragments/bootstrap :: bootstrap"/>
    </head>
    <body>
        <div id="fragmentsTop" th:include="fragments/essentials :: fragmentsTop"></div>

        <div id="stuffz">
            <div class="page-header">                
                <h1 th:inline="text">
                    [[${task.name}]] 
                    <!-- Test label -->
                    <span class="label label-success">DÃ¶n</span>
                </h1>

            </div>

            <div class="panel panel-default">
                <div class="panel-body">
                    <p th:if="${task.description}" th:text="${task.description}"></p>
                    <p th:text="${'Solution: ' + task.solution}"></p>                    
                </div>
                <div class="list-group">
                    <div id="queryForm" class="list-group-item well">
                        <form th:method="POST" role="form" th:action="@{__${#httpServletRequest.requestURI}__/query}">
                            <div class="form-group">
                                <label for="taskQuery">Perform query to database <a th:text="${database.name}" th:href="@{/databases/{dbId} (dbId=${database.id})}"></a></label>
                                <textarea name="query" id="taskQuery" placeholder="SHOW TABLES;" class="form-control" th:text="((${query}) ? ${query} : '')"></textarea>
                            </div>

                            <div class='form-group'>
                                <input class="btn btn-primary form-control" type="submit"/>
                            </div>
                        </form>
                    </div>

                    <div class="list-group-item" th:if="${tables}" th:include="fragments/essentials :: tableListing (tables = ${tables})">
                        <h4 class="list-group-item-heading">Query</h4>
                    </div>
                </div>
            </div>

            <div class="btn-toolbar" th:if="${role != 'STUDENT' or owned}">
                <div class="btn-group" th:if="${course}">
                    <form id="feedback" th:method="GET" th:action="@{/courses/{courseId}/category/{categoryId}/task/{taskId}/feedback (courseId = ${course.id}, categoryId=${category.id}, taskId=${task.id})}"></form>                
                    <button class="btn btn-default" form="feedback" th:text="'Give feedback to ' + ${task.name}"></button>
                </div>

                <div th:if="${role != 'STUDENT' or owned}" class="btn-group">
                    <form id="delete" th:method="DELETE" th:action="@{ {current} (current=${#httpServletRequest.requestURI})}"></form>
                    <form id="edit" th:method="GET" th:action="@{ {current}/edit (current=${#httpServletRequest.requestURI})}"></form>
                    <button class="btn btn-warning" form="edit">Edit task</button>
                    <button class="btn btn-danger" form="delete">Delete task</button>
                </div>

            </div>
            
            <nav>
                <ul class="pager">
                    <li th:if="${prev}" class="previous"><a th:href="@{__${#httpServletRequest.requestURI}__/prev}"><span aria-hidden="true">&larr;</span> Previous task</a></li>
                    <li th:if="${prev == null}" class="previous disabled"><a href="#"><span aria-hidden="true">&larr;</span> Previous task</a></li>
                    <li th:if="${next}" class="next"><a th:href="@{__${#httpServletRequest.requestURI}__/next}">Next task <span aria-hidden="true">&rarr;</span></a></li>
                    <li th:if="${next == null}" class="next disabled"><a href="#">Next task <span aria-hidden="true">&rarr;</span></a></li>
                </ul>
            </nav>            
        </div>        

        <div id="fragmentsBottom">
            <div th:if="${course}" th:include="fragments/scripts :: spyware (course = ${course}, task = ${task})"></div>
            <div th:include="fragments/footer_template :: footer"></div>
            <div th:include="fragments/scripts :: confirmScript"></div>        
        </div>        
    </body>

</html>
