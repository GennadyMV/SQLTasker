<!DOCTYPE html>
<!--
To change this license header, choose License Headers in Project Properties.
To change this template file, choose Tools | Templates
and open the template in the editor.
-->
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.w3.org/1999/xhtml">
    <head>
        <title th:text="${task.name}">Task name</title>
        <link th:include="fragments/bootstrap :: bootstrap"/>
    </head>
    <body>
        <div id="fragmentsTop" th:include="fragments/essentials :: fragmentsTop"></div>

        <div id="stuffz">
            <div class="page-header">
                <h1 th:text="${task.name}"></h1>
            </div>

            <div class="panel panel-default">
                <div class="panel-body">
                    <p th:if="${task.description}" th:text="${task.description}"></p>
                    <p th:text="${'Solution: ' + task.solution}"></p>                    
                </div>
                <div class="list-group">
                    <div id="queryForm" class="list-group-item well">
                        <form th:method="POST" role="form" th:action="@{__${#httpServletRequest.requestURI}__/query}">
                            <div class="form-group">
                                <label for="taskQuery">Perform query to database <a th:text="${database.name}" th:href="@{/databases/{dbId} (dbId=${database.id})}"></a></label>
                                <textarea name="query" id="taskQuery" placeholder="SHOW TABLES;" class="form-control" th:text="((${query}) ? ${query} : '')"></textarea>
                            </div>

                            <div class='form-group'>
                                <input class="btn btn-primary form-control" type="submit"/>
                            </div>
                        </form>
                    </div>

                    <div class="list-group-item" th:if="${tables}" th:include="fragments/essentials :: tableListing (tables = ${tables})">
                        <h4 class="list-group-item-heading">Query</h4>
                    </div>

                    <div id="tagsEtc" class="list-group-item">
                        <span class="label label-success">DÃ¶n</span>
                    </div>
                </div>


            </div>



            <div class="btn-toolbar" th:if="${role != 'STUDENT' or owned}">
                <div class="btn-group" th:if="${course}">
                    <form id="feedback" th:method="GET" th:action="@{/courses/{courseId}/category/{categoryId}/task/{taskId}/feedback (courseId = ${course.id}, categoryId=${category.id}, taskId=${task.id})}"></form>                
                    <button class="btn btn-default" form="feedback" th:text="'Give feedback to ' + ${task.name}"></button>
                </div>

                <div th:if="${role != 'STUDENT' or owned}" class="btn-group">
                    <form id="delete" th:method="DELETE" th:action="@{ {current} (current=${#httpServletRequest.requestURI})}"></form>
                    <form id="edit" th:method="GET" th:action="@{ {current}/edit (current=${#httpServletRequest.requestURI})}"></form>
                    <button class="btn btn-warning" form="edit">Edit task</button>
                    <button class="btn btn-danger" form="delete">Delete task</button>
                </div>

            </div>
        </div>

        <div>
            <ul>
                <li id="sql-li1">
                    <form th:method="DELETE" th:action="@{ {current} (current=${#httpServletRequest.requestURI})}">
                        <input id="sql-input1" type="submit" value="delete task" Onclick="return Confirm();"/>
                    </form>
                </li>
                <li id="sql-li2">
                    <form th:method="GET" th:action="@{ {current}/edit (current=${#httpServletRequest.requestURI})}">
                        <input id="sql-input2" type="submit" value="edit task" Onclick="return Confirm();"/>
                    </form>
                </li>
            </ul>

            <div class="get-in-touch">
                <h2 th:text="${task.name}">Task name</h2>
                <h3>Tags</h3>
                <div th:if="${tags}" th:each="tag : ${tags}">
                    <span th:text="${tag.name}">Tag name</span>
                </div>

                <h3 th:if="${task.description}">Description</h3>

                <p th:text="${task.description}">Task description</p>

                <h3 th:if="${task.solution}">Suggested solution</h3>

                <p th:text="${task.solution}">Task solution</p>

                <div th:if="${database}">
                    <h3>Database</h3>
                    <a th:text="${database.name}" th:href="@{/databases/{id} (id = ${database.id})}">Task database</a>    
                </div>
            </div>
        </div>


        <!-- SELECT query to a database results -->


        <div th:if="${course == null}">
            <div th:if="${category}">
                <a th:if="${next}" th:id="${next}" th:href="@{/categories/{id}/tasks/{nextId} (id=${category.id}, nextId=${next.id})}" th:text="'Next task: ' + ${next.name}">Next Task</a>
                <a th:id="${category}" th:href="@{/categories/{id} (id = ${category.id})}" th:text="'Back to ' + ${category.name}">Back to category</a>
            </div>
        </div>
        <div th:if="${course != null}">
            <div th:if="${category}">
                <a th:if="${next}" th:id="${next}" th:href="@{/courses/{courseId}/category/{id}/task/{nextId} (id=${category.id}, nextId=${next.id}, courseId=${course.id})}" th:text="'Next task: ' + ${next.name}">Next Task</a>
                <a th:id="${category}" th:href="@{courses/{courseId}/category/{id} (id = ${category.id}, courseId=${course.id})}" th:text="'Back to ' + ${category.name}">Back to category</a>
            </div>
        </div>

        <a th:if='${category == null}' th:href="@{/tasks}">Back to task listing</a>


        <a th:if="${course}" 
           th:href="@{/courses/{courseId}/category/{categoryId}/task/{taskId}/feedback (courseId = ${course.id}, categoryId=${category.id}, taskId=${task.id})}"
           th:text="'Give feedback to task ' + ${task.name}">               
        </a>

        <div id="fragmentsBottom">
            <div th:if="${course}" th:include="fragments/scripts :: spyware (course = ${course}, task = ${task})"></div>
            <div th:include="fragments/footer_template :: footer"></div>
            <div th:include="fragments/scripts :: confirmScript"></div>        
        </div>        
    </body>

</html>
